<div class="wrapper ">
    <div class="sidebar" data-color="purple" data-background-color="white" data-image="../assets/img/sidebar-1.jpg">
       <%= render "partials/sidebar"%> 
       <%= render "partials/navbar"%> 
      <%= form_with(model: @sell, local: true) do |form| %>
        <% if @sell.errors.any? %>
            <div id="error_explanation">
            <h2><%= pluralize(@sell.errors.count, "error") %> prohibited this buy from being saved:</h2>

            <ul>
                <% @sell.errors.full_messages.each do |message| %>
                <li><%= message %></li>
                <% end %>
            </ul>
            </div>
        <% end %>
        <div class="content">
          <div class="container-fluid">
            <div class="row">
              <div class="col-md-8">
                <div class="card">
                  <div class="card-header card-header-primary">
                    <h4 class="card-title">Editar uma venda</h4>
                  </div>
                  <div class="card-body">
                    <form>
                      <div class="row">
                        <div class="col-md-5">
                          <div class="form-group">
                            <label class="bmd-label-floating">Nome do produto</label>
                            <%= form.select("product_id", @product_options, { include_blank: 'Selecione...' }, class:"form-control") %>
                          </div>
                        </div>
                         <div class="col-md-4">
                          <div class="form-group">
                            <label class="bmd-label-floating">Unidade de medida</label>
                            <%= form.select :unity, ['unidade (un)',
                                              'metro (m)',
                                              'quilômetro (km)', 
                                              'hectômetro (hm)', 
                                              'decâmetro (dam)', 
                                              'decímetro (dm)', 
                                              'centímetro (cm)', 
                                              'milímetro (mm)',
                                              'litro (l)',
                                              'quilolitro (kl)', 
                                              'hectolitro (hl)', 
                                              'decalitro (dal)', 
                                              'decilitro (dl)', 
                                              'centilitro (cl)', 
                                              'mililitro (ml)',
                                              'tonelada (t)',
                                              'quilograma (kg)', 
                                              'hectograma (hg)', 
                                              'decagrama (dag)', 
                                              'grama (g)', 
                                              'decigrama (dg)', 
                                              'centigrama (cg)', 
                                              'miligrama (mg)',
                                              'metro cúbico (m3)',
                                              'quilômetro cúbico (km3)', 
                                              'hectômetro cúbico (hm3)', 
                                              'decâmetro cúbico (dam3)', 
                                              'decímetro cúbico (dm3)', 
                                              'centímetro cúbico (cm3)',  
                                              'milímetro cúbico (mm3)'],class:"form-control" %>
                          </div>
                      </div>

                        
                        <div class="col-md-12">
                          <div class="form-group">
                            <label class="bmd-label-floating">Nome do fornecedor</label>
                                <%= form.select("client_id", @client_options, { include_blank: 'Selecione...' }, class:"form-control") %>
                          </div>
                        </div>

                      </div>
                      <div class="row">
                        <div class="col-md-6">
                          <div class="form-group">
                            <label class="bmd-label-floating">Quantidade</label>
                            <%= form.text_field :quantity, class:"form-control" %>
                          </div>
                        </div>

                        <div class="col-md-6">
                          <div class="form-group">
                            <label class="bmd-label-floating">Preço</label>
                            <%= form.text_field :price, class:"form-control" %>
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-12">
                          <div class="form-group">
                            <label class="bmd-label-floating">Descrição do produto</label>
                            <%= form.text_field :description, class: "form-control" %>
                          </div>
                        </div>
                      </div>
                      <%= form.fields_for :tax do |f| %>
                      <div class="row">
                        <div class="col-md-6">
                          <div class="form-group">
                            <label class="bmd-label-floating">Frete</label>
                            <%= f.text_field :shipping, class:"form-control" %>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <div class="form-group">
                            <label class="bmd-label-floating">Taxa de IPI</label>
                            <%= f.text_field :ipi, class:"form-control" %>
                          </div>
                        </div>
                      </div>

                      <div class="row">
                        <div class="col-md-6">
                          <div class="form-group">
                            <label class="bmd-label-floating">Taxa de ICMS</label>
                            <%= f.text_field :icms, class:"form-control" %>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <div class="form-group">
                            <label class="bmd-label-floating">Custo adicional</label>
                            <%= f.text_field :costAdd, class:"form-control" %>
                          </div>
                        </div>
                      </div>
                      <div class="col-md-12">
                          <div class="form-group">
                            <label class="bmd-label-floating">Descrição do custo adicional</label>
                            <%= f.text_field :description, class: "form-control" %>
                          </div>
                        </div>
                            
                        <% end %> 
                       <div class="actions">
                        <%= link_to 'Voltar', sells_path,  class:"btn btn-primary pull-right" %>
                      </div>
                      <div class="actions">
                        <%= form.submit "Editar venda", class:"btn btn-primary pull-right"%>
                      </div>
                      <div class="clearfix"></div>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      <% end %>
      <%= render "partials/footer"%>
    </div>
  </div>
 
  <script>
    $(document).ready(function() {
      $().ready(function() {
        $sidebar = $('.sidebar');

        $sidebar_img_container = $sidebar.find('.sidebar-background');

        $full_page = $('.full-page');

        $sidebar_responsive = $('body > .navbar-collapse');

        window_width = $(window).width();

        fixed_plugin_open = $('.sidebar .sidebar-wrapper .nav li.active a p').html();

        if (window_width > 767 && fixed_plugin_open == 'Dashboard') {
          if ($('.fixed-plugin .dropdown').hasClass('show-dropdown')) {
            $('.fixed-plugin .dropdown').addClass('open');
          }

        }

        $('.fixed-plugin a').click(function(event) {
          // Alex if we click on switch, stop propagation of the event, so the dropdown will not be hide, otherwise we set the  section active
          if ($(this).hasClass('switch-trigger')) {
            if (event.stopPropagation) {
              event.stopPropagation();
            } else if (window.event) {
              window.event.cancelBubble = true;
            }
          }
        });

        $('.fixed-plugin .active-color span').click(function() {
          $full_page_background = $('.full-page-background');

          $(this).siblings().removeClass('active');
          $(this).addClass('active');

          var new_color = $(this).data('color');

          if ($sidebar.length != 0) {
            $sidebar.attr('data-color', new_color);
          }

          if ($full_page.length != 0) {
            $full_page.attr('filter-color', new_color);
          }

          if ($sidebar_responsive.length != 0) {
            $sidebar_responsive.attr('data-color', new_color);
          }
        });

        $('.fixed-plugin .background-color .badge').click(function() {
          $(this).siblings().removeClass('active');
          $(this).addClass('active');

          var new_color = $(this).data('background-color');

          if ($sidebar.length != 0) {
            $sidebar.attr('data-background-color', new_color);
          }
        });

        $('.fixed-plugin .img-holder').click(function() {
          $full_page_background = $('.full-page-background');

          $(this).parent('li').siblings().removeClass('active');
          $(this).parent('li').addClass('active');


          var new_image = $(this).find("img").attr('src');

          if ($sidebar_img_container.length != 0 && $('.switch-sidebar-image input:checked').length != 0) {
            $sidebar_img_container.fadeOut('fast', function() {
              $sidebar_img_container.css('background-image', 'url("' + new_image + '")');
              $sidebar_img_container.fadeIn('fast');
            });
          }

          if ($full_page_background.length != 0 && $('.switch-sidebar-image input:checked').length != 0) {
            var new_image_full_page = $('.fixed-plugin li.active .img-holder').find('img').data('src');

            $full_page_background.fadeOut('fast', function() {
              $full_page_background.css('background-image', 'url("' + new_image_full_page + '")');
              $full_page_background.fadeIn('fast');
            });
          }

          if ($('.switch-sidebar-image input:checked').length == 0) {
            var new_image = $('.fixed-plugin li.active .img-holder').find("img").attr('src');
            var new_image_full_page = $('.fixed-plugin li.active .img-holder').find('img').data('src');

            $sidebar_img_container.css('background-image', 'url("' + new_image + '")');
            $full_page_background.css('background-image', 'url("' + new_image_full_page + '")');
          }

          if ($sidebar_responsive.length != 0) {
            $sidebar_responsive.css('background-image', 'url("' + new_image + '")');
          }
        });

        $('.switch-sidebar-image input').change(function() {
          $full_page_background = $('.full-page-background');

          $input = $(this);

          if ($input.is(':checked')) {
            if ($sidebar_img_container.length != 0) {
              $sidebar_img_container.fadeIn('fast');
              $sidebar.attr('data-image', '#');
            }

            if ($full_page_background.length != 0) {
              $full_page_background.fadeIn('fast');
              $full_page.attr('data-image', '#');
            }

            background_image = true;
          } else {
            if ($sidebar_img_container.length != 0) {
              $sidebar.removeAttr('data-image');
              $sidebar_img_container.fadeOut('fast');
            }

            if ($full_page_background.length != 0) {
              $full_page.removeAttr('data-image', '#');
              $full_page_background.fadeOut('fast');
            }

            background_image = false;
          }
        });

        $('.switch-sidebar-mini input').change(function() {
          $body = $('body');

          $input = $(this);

          if (md.misc.sidebar_mini_active == true) {
            $('body').removeClass('sidebar-mini');
            md.misc.sidebar_mini_active = false;

            $('.sidebar .sidebar-wrapper, .main-panel').perfectScrollbar();

          } else {

            $('.sidebar .sidebar-wrapper, .main-panel').perfectScrollbar('destroy');

            setTimeout(function() {
              $('body').addClass('sidebar-mini');

              md.misc.sidebar_mini_active = true;
            }, 300);
          }

          // we simulate the window Resize so the charts will get updated in realtime.
          var simulateWindowResize = setInterval(function() {
            window.dispatchEvent(new Event('resize'));
          }, 180);

          // we stop the simulation of Window Resize after the animations are completed
          setTimeout(function() {
            clearInterval(simulateWindowResize);
          }, 1000);

        });
      });
    });
  </script>